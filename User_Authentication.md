Authentication is the process of verifying the identity of a client. When access control is enabled, MongoDB requires all clients to authenticate themselves in order to determine their access.

Although authentication and authorization are closely connected, authentication is distinct from authorization:

Authentication verifies the identity of a user.

Authorization determines the verified user's access to resources and operations.

Authentication Mechanisms

- SCRAM Authentication
Salted Challenge Response Authentication Mechanism (SCRAM) is the default authentication mechanism for MongoDB. When a user authenticates themselves, MongoDB uses SCRAM to verify the supplied user credentials against the user's name, password, and authentication database.

SCRAM is based on the IETF RFC 5802 standard that defines best practices for the implementation of challenge-response mechanisms for authenticating users with passwords.

Features

MongoDB's implementation of SCRAM provides:

-  A tunable work factor (the iteration count)
- Per-user random salts
- Bi-directional authentication between server and client
MongoDB supports the following SCRAM mechanisms: SCRAM-SHA-1, SCRAM-SHA-256.

When you create or update a SCRAM user, you can indicate the SCRAM mechanism to use whether the server or the client digests the password. When you use SCRAM-SHA-256, MongoDB requires server-side password hashing, which means that the server digests the password.
       

- x.509 Certificate Authentication
  MongoDB supports x.509 certificate authentication for client authentication and internal authentication of the members of 
  replica sets and sharded clusters. x.509 certificate authentication requires a secure TLS/SSL connection.
  To use MongoDB with x.509, you must use valid certificates generated and signed by a certificate authority. The client 
  x.509 certificates must meet the client certificate requirements.
  
  Certificate Authority
  
   For production use, your MongoDB deployment should use valid certificates generated and signed by a certificate authority. You or your organization can generate and maintain an independent certificate authority, or use certificates generated by third-party TLS vendors. Obtaining and managing certificates is beyond the scope of this documentation.

  Client x.509 Certificates
  
To authenticate to servers, clients can use x.509 certificates instead of usernames and passwords.

Client Certificate Requirements

Client certificate requirements:

A single Certificate Authority (CA) must issue the certificates for both the client and the server.

Each unique MongoDB user must have a unique certificate.

The x.509 certificate must not be expired.

Client certificates must contain the following fields:

keyUsage = digitalSignature
extendedKeyUsage = clientAuth

At least one of the following client certificate attributes must be different than the attributes in both the net.tls.clusterFile and net.tls.certificateKeyFile server certificates:

- Organization (O)

- Organizational Unit (OU)

- Domain Component (DC)

The subject of a client x.509 certificate, which contains the Distinguished Name (DN), must be different than the subjects of member x.509 certificates.

- MongoDB User and $external Database

To authenticate with a client certificate, you must first add the client certificate's subject as a MongoDB user in the $external database. The $external database is the Authentication Database for the user.

To use Client Sessions and Causal Consistency Guarantees with $external authentication users (Kerberos, LDAP, or x.509 users), usernames cannot be greater than 10k bytes.

- MongoDB Configuration for Membership Authentication

- MongoDB Configuration for Membership Authentication
  
You can use TLS for internal authentication between each member of your replica set (each mongod instance) or sharded cluster (each mongod and mongos instance).

To use TLS for internal authentication, use the following settings:

security.clusterAuthMode or --clusterAuthMode set to x509

net.tls.clusterFile or --tlsClusterFile (available starting in MongoDB 4.2)

- Kerberos Authentication

  In a Kerberos-based system, every participant in the authenticated communication is known as a "principal", and every principal must have a unique name.

Principals belong to administrative units called realms. For each realm, the Kerberos Key Distribution Center (KDC) maintains a database of the realm's principal and the principals' associated "secret keys".

For a client-server authentication, the client requests from the KDC a "ticket" for access to a specific asset. KDC uses the client's secret and the server's secret to construct the ticket which allows the client and server to mutually authenticate each other, while keeping the secrets hidden.

  User Principal

  Service Principal
- LDAP Proxy Authentication
- OpenID Connect Authentication
- Internal / Membership Authentication
